# архітектурні правила для space invaders

Цей документ встановлює технічні обмеження та структурні норми для проєкту. Ми закріплюємо мінімальний набір інструментів і чіткі правила залежностей щоб отримати передбачувану якість коду та повторювані результати під час роботи з AI агентами.

## технологічна основа

Мова Python версії 3.12. Графіка та ввід через бібліотеку pygame-ce. Збірка залежностей і запуск через uv. Пакування проєкту через pyproject.toml з бекендом hatchling. Статична типізація через mypy. Форматування через black. Лінтинг і швидкі перевірки стилю через ruff. Тести через pytest. Збірка автономного виконуваного файлу за потреби через PyInstaller.

## структура репозиторію

Корінь містить каталоги docs src assets tests та конфігураційні файли. Каталог assets містить підкаталоги images sounds fonts та data. Каталог src містить простір імен game з модулями core domain infra та ui. Головна точка входу розміщена у файлі src/main.py. У каталозі docs зберігаються вимоги арх правил та план. У каталозі tests зберігаються юніт тести та фікстури.

### приклад дерева структури

```
/
  docs/
    requirements.md
    arch_rules.md
    plan.md
  src/
    main.py
    game/
      core/
      domain/
      infra/
      ui/
  assets/
    images/
    sounds/
    fonts/
    data/
  tests/
    unit/
    integration/
  pyproject.toml
```

## модульні межі

Модуль core не знає про формат файлів ресурсів і не має доступу до системних деталей бібліотеки pygame-ce окрім абстракцій вводу і виводу. Модуль domain не імпортує нічого з ui і infra. Усі залежності спрямовані ззовні всередину. Модуль ui взаємодіє з core через інтерфейси подій та команди. Модуль infra постачає адаптери для завантаження ресурсів таймінгу та логування.

## головний цикл і час

Оновлення логіки виконується з фіксованим кроком. Рендеринг може виконуватись частіше якщо дозволяє апаратне прискорення. Обробка вводу відбувається перед оновленням логіки на кожному кроці. Кожне оновлення приймає dt у секундах як число з плаваючою крапкою що узгоджено з частотою шістдесят кроків на секунду. Події зіткнення перетворюються на команди які застосовуються атомарно.

## правила код стилю

Іменування модулів і пакетів у зміїному регістрі. Класи у верхньому верблюжому регістрі тільки в коді. Публічні функції та методи мають типові анотації. Заборонено приховані глобальні змінні для стану сцени.
