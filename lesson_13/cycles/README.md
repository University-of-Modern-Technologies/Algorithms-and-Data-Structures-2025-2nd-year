# Цикли в графах: Теорія та Алгоритми

## Що таке цикл?
У теорії графів **цикл** — це шлях, який починається і закінчується в одній і тій самій вершині, і при цьому не містить повторюваних ребер або вершин (окрім першої/останньої).
- **У неорієнтованому графі:** Шлях $v_1, v_2, ..., v_k, v_1$, де $k \ge 3$.
- **В орієнтованому графі:** Шлях, де всі переходи відбуваються за напрямком стрілок.

## Прості цикли (Simple Cycles) в орієнтованих графах
Простий (або елементарний) цикл не містить повторюваних вершин, окрім початкової/кінцевої.

### Складність проблеми
Знаходження **всіх** циклів у графі — це NP-складна задача. Кількість циклів може зростати експоненційно зі збільшенням кількості вершин. У повному графі $K_n$ кількість циклів порядку $O((n-1)!)$.

### Алгоритм Джонсона (Johnson's Algorithm)
NetworkX у функції `nx.simple_cycles` використовує алгоритм Джонсона.
- Це найефективніший алгоритм для пошуку всіх елементарних циклів.
- **Часова складність:** $O((V + E)(C + 1))$, де $C$ — кількість знайдених циклів. Для графів з великою кількістю циклів це може бути дуже довго, але для розріджених графів працює швидко.
- Він використовує пошук у глибину (DFS) з блокуванням вершин, щоб уникнути повторного перегляду безперспективних шляхів.

## Базис циклів (Cycle Basis) у неорієнтованих графах
Часто не потрібно знаходити *всі* можливі цикли (яких може бути мільйони), а достатньо знайти **фундаментальний набір** циклів, з комбінації яких можна утворити будь-який інший цикл.

### Визначення
Базис циклів — це мінімальна множина циклів така, що будь-який цикл у графі може бути представлений як симетрична різниця (операція XOR над множинами ребер) циклів з базису.

### Цикломатичне число
Кількість циклів у базисі є інваріантом графа і називається **цикломатичним числом** (або рангом циклу):
$$ M = E - V + C $$
Де:
- $E$ — кількість ребер.
- $V$ — кількість вершин.
- $C$ — кількість компонент зв'язності.

### Алгоритм побудови
1. Знайти кістякове дерево (Spanning Tree) графа (наприклад, за допомогою BFS або DFS). Воно містить $V-1$ ребер (для однієї компоненти зв'язності) і не має циклів.
2. Всі ребра, що не увійшли до дерева, називаються **хордами** або зворотними ребрами.
3. Кожна хорда при додаванні до дерева утворює **рівно один** фундаментальний цикл.
4. Множина всіх таких циклів утворює базис.

### Практичне значення
Базис циклів критично важливий у:
- **Електротехніці:** Для складання рівнянь за правилами Кірхгофа (метод контурних струмів).
- **Хімії:** Для опису кільцевих структур молекул.
- **Мережевому аналізі:** Для дослідження надлишковості мережі.

Функція `nx.cycle_basis` у NetworkX реалізує цей підхід, зазвичай використовуючи кістякове дерево, побудоване за допомогою BFS, що дає "короткі" цикли.
